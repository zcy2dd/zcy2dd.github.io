---
layout: post
title:  'CDH安装指南'
date:   2019-1-28 23:04:47
tags: CDH安装
color: 'rgb(100,149,237)'
subtitle: 'CDH环境的配置以及安装'
cover: 'https://blog-1253533258.cos.ap-shanghai.myqcloud.com/2019-1-14/RDD%E5%88%92%E5%88%86.png'
---



## CDH安装

### 1. 准备工作

#### 1.1 环境准备

1. 个人电脑一台，操作系统需安装ssh、ftp工具

   - 本次安装使用个人电脑使用Win10，ssh工具：xshell、ftp工具：xftp

2. 服务器

   | 主机名  | 物理内存(G) | CPU核数(核) | 数据磁盘(G) | IP地址          |
   | ------- | ----------- | ----------- | ----------- | --------------- |
   | hadoop1 | 6           | 2           | 60          | 192.168.120.101 |
   | hadoop2 | 4           | 3           | 60          | 192.168.120.102 |
   | hadoop3 | 4           | 3           | 60          | 192.168.120.103 |

   操作系统：CentOS - 7 - x86 -Minimal

3. 软件包下载

- CentOS7.2 Packages 

  ```bash
  wget -r -p -np -k http://vault.centos.org/7.2.1511/os/x86_64/Packages/ （6G）
  ```

- CDH Parcel和manifest文件、CM

  ```bash
  wget  http://archive.cloudera.com/cdh5/parcels/5.7.2/CDH-5.7.2-1.cdh5.7.2.p0.18-el7.parcel （1.3G）
  wget  http://archive.cloudera.com/cdh5/parcels/5.7.2/CDH-5.7.2-1.cdh5.7.2.p0.18-el7.parcel.sha1 （41K）
  wget  http://archive.cloudera.com/cdh5/parcels/5.7.2/manifest.json （49K）
  wget  http://archive.cloudera.com/cm5/cm/5/cloudera-manager-centos7-cm5.7.2_x86_64.tar.gz（600M）
  ```

- JDK：jdk-8u25

### 2. 基础环境搭建

#### 2.1 修改IP

本次使用的是虚拟机，NAT模式，将Ip修改为静态模式，方便后续cdh配置

以hadoop1为例

```bash
vi /etc/sysconfig/network-scripts/ifcfg-eno16777728

# 修改或添加一下内容
BOOTPROTO="static"
IPADDR="你的静态IP"
NETMASK="255.255.255.0"
NETWORK="网关地址"

# 重启网卡
service network restart
```

#### 2.2 HTTP软件仓库

这是一个可选项，安装后可不依赖网络，直接从本地软件仓库下载软件

```bash
# 解压Package包
tar -zxvf centos
# 解压后目录结构：/data01/Packages
# 安装httpd软件
cd  /data01/Packages
rpm -ivh  apr-1.4.8-3.el7.x86_64.rpm 
rpm -ivh  apr-util-1.5.2-6.el7.x86_64.rpm 
rpm -ivh  httpd-tools-2.4.6-40.el7.centos.x86_64.rpm 
rpm -ivh  mailcap-2.1.41-2.el7.noarch.rpm
rpm -ivh  httpd-2.4.6-40.el7.centos.x86_64.rpm
# 启动httpd，并设置开机启动
systemctl   start    httpd
systemctl   enable   httpd
# 安装createrepo仓库构建工具
cd  /data01/Packages
rpm -ivh  deltarpm-3.6-3.el7.x86_64.rpm 
rpm -ivh  python-deltarpm-3.6-3.el7.x86_64.rpm 
rpm -ivh  libxml2-python-2.9.1-5.el7_1.2.x86_64.rpm 
rpm -ivh  libxml2-2.9.1-5.el7_1.2.x86_64.rpm 
rpm -ivh  createrepo-0.9.9-23.el7.noarch.rpm 
# 创建软链接
cd  /var/www/html/
mkdir  /var/www/html/CentOS7.2/
ln -s  /data01/Packages   /var/www/html/CentOS7.2/Packages
chmod 755 -R /var/www/html/CentOS7.2/Packages 
# 关闭防火墙
setenforce 0 
```

createrepo安装成功

![](https://blog-1253533258.cos.ap-shanghai.myqcloud.com/2019-1-28/success1.png)

仓库搭建成功

<img src="https://blog-1253533258.cos.ap-shanghai.myqcloud.com/2019-1-28/success2.png" width="50%" height="50%">

##### 2.2.1 配置repo

给所有直接配置repo源

```bash
# 备份默认文件
cd /etc/yum.repos.d/
mkdir  bak
mv CentOS-*.repo  bak/
# 创建源文件
vi  base.repo
# 一下为文件内容
[base]
name=CentOS-Packages
baseurl=http://192.160.120.101/CentOS7.2/Packages/
gpgkey=
path=/
enabled=1
gpgcheck=0

# 检查是否配置成功
# 清理yum源
yum clean all
# 重构yum缓存
yum makecache
# 在yum源中找到vim
yum list|grep vim 
```

